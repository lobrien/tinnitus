# Tinnitus Notch Filter File Generator
**Command-line only**

Python, developed on MacOS
(I used Python 3.13, but the code doesn't use anything more advanced than type hints)

**⚠️ DISCLAIMER: NOT MEDICAL ADVICE**

**This software is provided for educational and experimental purposes only.**

* It is **not** a medical device.
* It is **not** intended to diagnose, treat, cure, or prevent any disease or medical condition, including tinnitus.
* The audio generated by this tool should **not** be used as a substitute for professional medical advice, diagnosis, or treatment.

**Always seek the advice of your physician or other qualified health provider with any questions you may have regarding a medical condition.**

**Safety Warning:** High-volume audio can cause permanent hearing damage. Always ensure your volume is set to a safe, low level before playing generated noise. Use this tool at your own risk.

---

An audio tool that generates spectral noise (White, Pink, Brown) with configurable notch filters. For investigation of [acoustic neuromodulation protocols](https://www.pnas.org/doi/10.1073/pnas.0911268107) (e.g., "notched music therapy") to target specific tinnitus frequencies. 

[r/tinnitus](https://www.reddit.com/r/tinnitus)

This video provides a practical demonstration of how notched white noise and neuromodulation tones may be something worth investigating: 

https://www.youtube.com/watch?v=O8ypzXTHi1E

I used several different online tone generators to try to match my tinnitus. Eventually I decided I'm somewhere near 5800Hz. The default notch is pretty wide, I imagine that the more precise you can make the notch the better (`--width` has a default of `1.0`, a full octave), but I'm kind of tone-deaf and I can only approximate my tone.  

## Features

* **Spectral Noise Generation:** Validated generators for White ($1/f^0$), Pink ($1/f^1$), and Brown ($1/f^2$) noise.
* **Precision Notching:** Configurable center frequency and bandwidth (in octaves).
* **Verification Analysis:** Integrated spectral analyzer to confirm notch depth in generated or existing audio files.
* **High-Fidelity Output:** Defaults to FLAC (lossless) with float32 processing. Also outputs .OGG or .WAV. Apple ALAC (.m4a) manual conversion from FFMpeg. 

**Important: Use good earphones and do not convert to a lossy format, which smear the high frequencies**

## ⚠️ System Requirements

**External Dependency: FFmpeg**
The `verify` command relies on `ffmpeg` and `ffprobe` to decode audio streams and analyze sample rates. These binaries must be installed and available in your system `$PATH`. (You can still generate files without `ffmpeg`, but why wouldn't you have `ffmpeg` on your system?)

* See [INSTALLATION.md](INSTALLATION.md) for OS-specific setup instructions.

## Quick Start

### Installation

```bash
# Clone the repository
git clone [https://github.com/yourusername/tinnitus.git](https://github.com/yourusername/tinnitus.git)
cd tinnitus

# Install with uv (recommended)
uv pip install -e .
```

### Usage

The package exposes a single CLI entry point `tinnitus` with two subcommands.

1. Generate Noise

Generate 60 seconds of Pink noise with a notch at 6000 Hz.

```bash
tinnitus generate --freq 6000 --type pink --duration 60 --output therapy.flac
Flag	Description	Default
--freq	Center frequency of the notch (Hz)	Required
--type	Noise color (white, pink, brown)	pink
--width	bandwith of the notch in octaves	1.0
--output	Output filename (.flac, .wav, .ogg)	output.flac
```

2. Verify Audio

Analyze an audio file to confirm the notch depth. Requires FFmpeg.

```bash
tinnitus verify therapy.flac --freq 6000 --plot analysis.png
```

3. On Mac, use FFMpeg to convert to Apple's ALAC

```bash
ffmpeg -i therapy.flac -c:a alac therapy.m4a
```

### Development
Run the typechecker and test suite to validate argument parsing, spectral physics, and CLI dispatch.

```bash
uv run mypy
uv run pytest
```

Pull requests welcome! 

(While I didn't use Claude for this, I've created a CLAUDE.md that hopefully captures my style preferences. I'm all for LLM assistance but I have strong opinions about code.)

### Roadmap

I'd never even heard of notched sound therapy until two days ago and slapped this together for my own experimentation. I'm an idiot and know nothing about potential harms or side effects: you should not use this software without knowing more about this subject than I do. 

I will **not** be adding asymmetrical stereo. Even if one has asymmetric tinnitus (as do I), apparently it's important that both ears get the same input. If you know different, send me the paper and I'll consider it.

Actually, if **anything** about this flies in the face of science, send me the paper. 

I think the next logical feature would be "tone quality," sine/square/triangle/sawtooth, etc. but my initial thought implies $n(\text{NoiseType}) \ast n(\text{ToneQuality})$ outputs and so `NoiseStrategy` goes from trivial to at least somewhat complex. I'll probably not do that until I see more evidence that this type of ~~therapy~~ educational exploration has an effect.    

After that, I'd think adding a notch to existing music files. For my own purposes, I'm not planning on that, because I tune out sound while reading, writing, or coding, so pink noise is as good as music for me. 

Code-wise it seems trivial enough, but then you have to manage a library of original and `_notched` music and that seems like it might be a pain. 
